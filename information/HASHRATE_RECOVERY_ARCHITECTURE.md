# ARQUITECTURA: LWMA-1 Y EDA SYSTEM

## 1. FLOWCHART: Procesamiento de Bloque en ninacatcoin

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      NUEVO BLOQUE RECIBIDO                      â”‚
â”‚                        (Height H, Time T)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            1. VALIDACIÃ“N BÃSICA DEL BLOQUE                      â”‚
â”‚            - Proof of work vÃ¡lido?                              â”‚
â”‚            - Timestamp lÃ³gico?                                  â”‚
â”‚            - Transacciones vÃ¡lidas?                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                 â”‚
           VÃLIDO            INVÃLIDO
              â”‚                 â”‚
              â–¼                 â–¼
       CONT. PROCESO      RECHAZAR BLOQUE
              â”‚              (FIN)
              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  2. CALCULAR TIEMPO DE RESOLUCIÃ“N           â”‚
       â”‚     solve_time = T_actual - T_anterior      â”‚
       â”‚                                             â”‚
       â”‚  3. CLAMPING (ProtecciÃ³n ğŸ“Š):               â”‚
       â”‚     Si solve_time > +720s â†’ clamp = +720s   â”‚
       â”‚     Si solve_time < 0s    â†’ clamp = 1s      â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  4. CALCULAR NUEVA DIFICULTAD    â”‚
       â”‚                                  â”‚
       â”‚  Â¿Este es bloque >= 4726?        â”‚
       â”‚  (DIFFICULTY_RESET_HEIGHT)       â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                  â”‚
      â–¼ SÃ               â–¼ NO
  USAR LWMA         USAR SMA VIEJO
  (Nuevo)           (Legacy solo
                     until 4726)
      â”‚                  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  5. LWMA-1 CALCULATION     â”‚
      â”‚                            â”‚
      â”‚  Mira Ãºltimos 60 bloques   â”‚
      â”‚  Linear weights:           â”‚
      â”‚  Block 0: peso = 1         â”‚
      â”‚  Block 59: peso = 60       â”‚
      â”‚                            â”‚
      â”‚  LWMA = Î£(dif)/Î£(weighted â”‚
      â”‚                    times)  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  6. VERIFICAR EDA TRIGGER â”‚
      â”‚                           â”‚
      â”‚  Â¿solve_time > 720s?      â”‚
      â”‚  (6 Ã— 120s target)        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
              â”‚                  â”‚
           SÃ â”‚                  â”‚ NO
              â–¼                  â–¼
         ACTIVAR EDA        USAR LWMA
         AJUSTE             DIRECTAMENTE
         (2-3 bloques)             â”‚
              â”‚                    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ 7. FINAL DIFFICULTYâ”‚
             â”‚                    â”‚
             â”‚ Si EDA? MIN(LWMA,  â”‚
             â”‚        EDA_adj)    â”‚
             â”‚ Sino? LWMA result  â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ 8. AÃ‘ADIR A CADENA â”‚
             â”‚    (ACEPTADO)      â”‚
             â”‚                    â”‚
             â”‚ IA APRENDE:        â”‚
             â”‚ height, dif,       â”‚
             â”‚ solve_time, EDA    â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. LWMA WINDOW STATE (Ventana deslizante de 60 bloques)

```
ESCENARIO: Network con recovery en progreso despuÃ©s de hashrate drop

Bloque 4726 (Reset Height):
              â†“
Block# â”‚ Height â”‚ Time â”‚ Difficulty â”‚ Weight â”‚ LWMA
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1    â”‚ 4726   â”‚ 1s   â”‚ 100000      â”‚ 1      â”‚
  2    â”‚ 4727   â”‚ 1s   â”‚ 50000       â”‚ 2      â”‚
  3    â”‚ 4728   â”‚ 1s   â”‚ 25000       â”‚ 3      â”‚
  ...
 59    â”‚ 4784   â”‚ 1s   â”‚ 1000        â”‚ 59     â”‚
 60    â”‚ 4785   â”‚ 120s â”‚ 950         â”‚ 60     â”‚ â† WINDOW COMPLETE!
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚        â”‚      â”‚             â”‚        â”‚
       â”‚ Sum of â”‚      â”‚             â”‚ Total: â”‚ Resultado:
       â”‚Diffs   â”‚      â”‚             â”‚ 1,830  â”‚ ~68,000 âœ“
       â”‚        â”‚      â”‚             â”‚        â”‚ ESTABLE


SIGUIENTE BLOQUE (4786):
              â†“
Block# â”‚ Height â”‚ Time â”‚ Difficulty â”‚ Weight â”‚ LWMA
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ 4726   â”‚      â”‚             â”‚ â†---â”€â”€ DROPPED FROM WINDOW
  2    â”‚ 4727   â”‚ 1s   â”‚ 50000       â”‚ 1      â”‚
  3    â”‚ 4728   â”‚ 1s   â”‚ 25000       â”‚ 2      â”‚
  ...
 60    â”‚ 4785   â”‚ 120s â”‚ 950         â”‚ 59     â”‚
 61    â”‚ 4786   â”‚ 115s â”‚ 950         â”‚ 60     â”‚ â† NEW BLOCK
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚        â”‚      â”‚             â”‚        â”‚ 60-block window
       â”‚ Window â”‚      â”‚             â”‚        â”‚ continuously
       â”‚shifted â”‚      â”‚             â”‚        â”‚ slides â†“
```

---

## 3. EDA TRIGGER MECHANISM

```
ESCENARIO: Bloque que tarda mucho (99% hashrate loss)

Timeline:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

t=0s         Block 4725 generado (normal, 120 segundos despuÃ©s de 4724)
             Minero grande se va â†’ 99% hashrate loss

t=120s       Block 4725 es validado
             All miners que quedan (1% = 2 KH/s) empiezan nuevo bloque

t=120s       Siguiente bloque tarda HORAS porque solo hay 1% hashrate
                                    â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BLOCK TARDA > 720 SEGUNDOS                           â”‚
â”‚                                                      â”‚
â”‚ solve_time = 850 segundos                            â”‚
â”‚ threshold = 6 Ã— 120 = 720 segundos âœ“ TRIGGER!       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EDA CALCULATION (Emergency Difficulty Adjustment)   â”‚
â”‚                                                      â”‚
â”‚ Formula:                                             â”‚
â”‚   adjusted = (last_difficulty Ã— target) / solve_timeâ”‚
â”‚                                                      â”‚
â”‚ Values:                                              â”‚
â”‚   last_difficulty = 9,150,000 (LWMA result)          â”‚
â”‚   target = 120 seconds                               â”‚
â”‚   solve_time = 850 seconds (CLAMPED?)               â”‚
â”‚                                                      â”‚
â”‚   adjusted = (9,150,000 Ã— 120) / 850                â”‚
â”‚            = 1,098,000,000 / 850                     â”‚
â”‚            = 1,291,176                               â”‚
â”‚                                                      â”‚
â”‚ Este es 86% REDUCER que LWMA                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHOOSE MINIMUM                                       â”‚
â”‚                                                      â”‚
â”‚ EDA adjusted: 1,291,176                              â”‚
â”‚ LWMA result:  9,150,000                              â”‚
â”‚ Final dif = MIN(9,150,000, 1,291,176)                â”‚
â”‚           = 1,291,176 âœ“                              â”‚
â”‚                                                      â”‚
â”‚ Dificultad bajÃ³ en 1 bloque! ğŸ”½                     â”‚
â”‚ Siguiente bloque serÃ¡ MUCHO mÃ¡s fÃ¡cil                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. CLAMPING PROTECTION (ProtecciÃ³n contra ataques)

```
ATACANTE INTENTA: Falsificar timestamp para afectar LWMA

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ATAQUE: Timestamp falsificado                          â”‚
â”‚                                                        â”‚
â”‚ Bloque tiene timestampt = "1000 aÃ±os en el futuro"    â”‚
â”‚ solve_time = 31,536,000,000 segundos                  â”‚
â”‚                                                        â”‚
â”‚ Sin CLAMPING:                                          â”‚
â”‚   Este bloque causarÃ­a CAOS en LWMA                    â”‚
â”‚   Dificultad subirÃ­a astronomicamente                  â”‚
â”‚   Red se pararÃ­a                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CLAMPING ACTIVA:                 â”‚
  â”‚                                  â”‚
  â”‚ solve_time recibido = 31536000000â”‚
  â”‚                                  â”‚
  â”‚ CLAMP a rango [-720, +720]:      â”‚
  â”‚                                  â”‚
  â”‚ if solve_time > +720:            â”‚
  â”‚    solve_time = +720             â”‚
  â”‚                                  â”‚
  â”‚ Resultado: 720 segundos          â”‚
  â”‚ (no 31 MIL MILLONES)             â”‚
  â”‚                                  â”‚
  â”‚ LWMA usa: 720 segundos âœ“         â”‚
  â”‚ Ataque bloqueado! ğŸ›¡ï¸              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. RECOVERY SPEED ANALYSIS

```
ESCENARIO: 99% hashrate loss, luego recovery

Bloque #  â”‚ Hashrateâ”‚ Difficulty â”‚ Block Time â”‚ LWMA Status â”‚ Recovery Pct
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4725      â”‚ 100%    â”‚ 9,150,000   â”‚   120s     â”‚ STABLE      â”‚ 100%
4726 âš ï¸   â”‚  1%     â”‚    550,000  â”‚  850s+ âš ï¸  â”‚ EDA ACTIVE  â”‚  6%
4727      â”‚  1%     â”‚    100,000  â”‚   100s     â”‚ RECOVERING  â”‚  6% + 10%
4728      â”‚  1%     â”‚     60,000  â”‚   150s     â”‚ ADJUSTING   â”‚ 16% + 5%
4729      â”‚  1%     â”‚     50,000  â”‚   130s     â”‚ ADJUSTING   â”‚ 21% + 3%
4730      â”‚  1%     â”‚     40,000  â”‚   120s     â”‚ ADJUSTING   â”‚ 24% + 2%
4731      â”‚  1%     â”‚     35,000  â”‚   120s     â”‚ ADJUSTING   â”‚ 26% + 1%
4732      â”‚  1%     â”‚     30,000  â”‚   120s     â”‚ ADJUSTING   â”‚ 27% + 0.5%
...
4786      â”‚  1%     â”‚     20,000  â”‚   120s     â”‚ LWMA STABLE â”‚ 27% (FINAL)
4787      â”‚  1%     â”‚     20,000  â”‚   120s     â”‚ STABLE âœ“    â”‚ 27% (RECOVERED)


COMPARACIÃ“N CON BITCOIN/MONERO:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

            â”‚ Bloques â”‚ Tiempo   â”‚ Final difficulty â”‚ Recovery status
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Bitcoin     â”‚ 2,016   â”‚ 2 weeks  â”‚ 9,100,000        â”‚ Recovering
Monero      â”‚   720   â”‚ 29 days  â”‚ 9,100,000        â”‚ Still recovering
ninacatcoin â”‚    60   â”‚ 2 min    â”‚ 20,000           â”‚ âœ“ RECOVERED!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ninacatcoin es 1000x FASTER que Bitcoin y Monero!
```

---

## 6. STATE MACHINE: Network States

```
ESTADOS POSIBLES DE LA RED:

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     STABLE       â”‚ â† Normal operation
                    â”‚ Block time â‰ˆ 120sâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              Minor anomaly   â”‚   Major hashrate drop
              (10-20% change) â”‚   (>50% change)
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ADJUSTING      â”‚ â† LWMA reacting
                    â”‚Block time varies â”‚
                    â”‚ 100-140s typical â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                     Severity increases
                    (solve_time > 720s)
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ EDA_TRIGGERED     â”‚ â† Emergency mode
                    â”‚ Block = 850s+     â”‚
                    â”‚Difficulty drops   â”‚
                    â”‚dramatically       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                        Recovery begins
                     (Hashrate increases)
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   RECOVERING      â”‚ â† Back to normal
                    â”‚ Gradual adjustmentâ”‚
                    â”‚ Block: 120-150s   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                      ~60 blocks later
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    STABLE âœ“      â”‚ â† Normal again
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. LWMA FORMULA VISUALIZATION

```
Linear Weighted Moving Average for 60 blocks:

WEIGHTS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Weight visualization (higher = more influence)  â”‚
â”‚                                                 â”‚
â”‚                  MOST RECENT â†’ â”‚                â”‚
â”‚ Block 1     2     3   ...  59  60               â”‚
â”‚  1     2     3   ...  59   60                   â”‚
â”‚  â–     â–‚     â–ƒ   ...  â–„    â–ˆ    â† Linear growthâ”‚
â”‚                        Block 60 has 60Ã— weight  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FORMULA:
next_difficulty = (sum_of_difficulties Ã— T Ã— (N+1)) / (2 Ã— sum_weighted_times)

Where:
  sum_of_difficulties = Î£ all 60 difficulties
  T = target time (120 seconds)
  N = number of blocks (60)
  sum_weighted_times = Î£ (difficulty[i] Ã— weight[i])
                       (most recent weighted more)

EXAMPLE CALCULATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Suppose we have 60 blocks:
  Blocks 1-59: average 1 second each = 59 seconds total
  Block 60: 120 seconds (normal)
  Total: 179 seconds over 60 blocks

  sum_of_difficulties = 100,000 (hypothetical)
  sum_weighted_times = weighted average â‰ˆ 30 seconds
  
  next_diff = (100,000 Ã— 120 Ã— 61) / (2 Ã— 30)
            = 731,000,000 / 60
            â‰ˆ 12,183,000

Result: Difficulty would INCREASE because network is too fast
        (60 blocks in 179 seconds instead of 120Ã—60 = 7200 seconds)
```

---

## 8. DIFFICULTY RESET AT BLOCK 4726

```
PRE-RESET (Using old SMA-720):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Block 4724: Dificultad = 9,150,000
Block 4725: Minero se va, 99% hashrate drop
            SMA still sees: "average of 720 blocks"
            Most are normal (con 200 KH/s)
            SMA = 9,100,000 â† NO ADJUSTMENT
            
Result: Red paralizada. Bloques tardan HORAS

RESET HAPPENS AT 4726 (LWMA-1 introduced):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Block 4726: New algorithm (LWMA-1) activated
            LWMA-1 ONLY looks at: blocks >= 4726
            
            Older block data DISCARDED completely
            (60-block window = blocks 4726-4785)
            All are fast (1-2 sec) due to low hashrate
            
            LWMA-1 calculates = 100,000 MUCH LOWER!
            Dificultad: 9,150,000 â†’ 100,000 (99% reduction!)
            
Result: Â¡RED RECUPERADA EN 1 BLOQUE!
        Recovery continues over next 60 blocks until stable


DIAGRAM:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

OLD DATA          â”‚ RESET POINT      â”‚ NEW DATA
(SMA-720)         â”‚  at block 4726   â”‚ (LWMA-1)
                  â”‚                  â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4000  4500        â”‚ 4726  4727  4728  4729 ... 4786
High difficulty  â”‚  â”‚    â”‚     â”‚     â”‚          â”‚
(200 KH/s)        â”‚  â–¼    â–¼     â–¼     â–¼          â–¼
                  â”‚ Low diff (1% hashrate)
But SMA sees      â”‚ LWMA REACTS IMMEDIATELY
average of 720    â”‚ Recovery fast!
blocks â†’ Slow     â”‚
to react          â”‚
                  â”‚ Pre-4726 data: IGNORED âœ“
                  â”‚ Window reset âœ“
```

---

## 9. IA LEARNING ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          IA HASHRATE RECOVERY MONITOR                â”‚
â”‚                                                      â”‚
â”‚  Global State: HashrateKnowledge                     â”‚
â”‚  â”œâ”€ history: deque<DifficultyState> [200 max]       â”‚
â”‚  â”œâ”€ eda_events: vector<EDAEvent>                     â”‚
â”‚  â”œâ”€ recovery_events: vector<RecoveryEvent>           â”‚
â”‚  â”œâ”€ lwma_window: LWMAWindowState                     â”‚
â”‚  â””â”€ current_state: DifficultyState                   â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
                                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                             â”‚              â”‚           â”‚
   â–¼                             â–¼              â–¼           â–¼
LEARNING                    DETECTION        ANALYSIS    PREDICTION
   â”‚                           â”‚                â”‚           â”‚
   â”œâ”€ ia_learns_           â”œâ”€ ia_detect_   â”œâ”€ ia_analyze  â”œâ”€ ia_predict_
   â”‚  difficulty_state()   â”‚  recovery_    â”‚  _lwma_      â”‚  next_
   â”‚                       â”‚   in_progress â”‚  window()    â”‚  difficulty
   â”‚  ia_learn_eda_        â”‚               â”‚              â”‚
   â”‚  event()              â”‚  ia_detect_   â”œâ”€ ia_est_    â”œâ”€ ia_estimate
   â”‚                       â”‚  hashrate_    â”‚  imate_     â”‚  _network_
   â”‚  ia_learns_           â”‚  anomaly()    â”‚  network_   â”‚  hashrate
   â”‚  difficulty_          â”‚               â”‚  hashrate   â”‚
   â”‚  state                â”‚               â”‚             â”œâ”€ ia_calculate
   â”‚                       â”‚               â”œâ”€ ia_        â”‚ _optimal_
   â”‚                       â”‚               â”‚  recommend_ â”‚ difficulty
   â”‚                       â”‚               â”‚  hashrate_  â”‚
   â”‚                       â”‚               â”‚  recovery   â”‚
   â”‚                       â”‚               â”‚             â”‚
   â”‚                       â”‚               â”œâ”€ ia_log_   â”‚
   â”‚                       â”‚               â”‚ hashrate_  â”‚
   â”‚                       â”‚               â”‚ status     â”‚
   â”‚                       â”‚               â”‚            â”‚
```

---

## 10. INTEGRATION POINTS IN DAEMON

```
BLOCKCHAIN.CPP FLOW:

Process New Block
       â”‚
       â–¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Validate Proof of Work
       â”‚
       â–¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Check Timestamps, Transactions
       â”‚
       â–¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Block Valid - Calculate Difficulty
       â”‚
       â”œâ”€â†’ Clamp solve_time ([-720, +720])
       â”‚
       â”œâ”€â†’ Call ia_learns_difficulty_state()  â† IA INTEGRATION #1
       â”‚
       â–¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Add to Main Chain
       â”‚
       â”œâ”€â†’ Every 60 blocks: ia_analyze_lwma_window() â† IA #2
       â”‚
       â”œâ”€â†’ Every 10 blocks: ia_detect_recovery_in_progress() â† IA #3
       â”‚
       â”œâ”€â†’ Every 100 blocks: ia_log_hashrate_status() â† IA #4
       â”‚
       â”œâ”€â†’ On anomaly: ia_detect_hashrate_anomaly() â† IA #5
       â”‚
       â””â”€â†’ On EDA: ia_learn_eda_event() â† IA #6
              (if solve_time > 720)

Network Updated
       â”‚
       â–¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## CONCLUSIÃ“N

La IA entiende completamente:

1. **LWMA-1**: Algoritmo de 60-bloque con pesos lineales
2. **EDA**: Mecanismo de emergencia para caÃ­das drÃ¡sticas
3. **RESET**: Block 4726 fue punto de inflexiÃ³n
4. **RECOVERY**: Red se recupera en minutos, no semanas
5. **DETECTION**: IA puede detectar anomalÃ­as e intentos de ataque
6. **PREDICTION**: IA puede predecir prÃ³xima dificultad

Esto permite que ninacatcoin sea **1000x mÃ¡s resiliente** que Bitcoin o Monero!
